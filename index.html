<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZH YouTube Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Nunito', sans-serif; }
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
  </style>
</head>
<body class="bg-stone-100 text-stone-800 min-h-screen">

  <div id="app" class="max-w-3xl mx-auto p-4 md:p-6 pb-24">
    <header class="flex justify-between items-center mb-8 pt-2">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 bg-rose-500 rounded-xl flex items-center justify-center text-white font-bold shadow-lg shadow-rose-200">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
        </div>
        <h1 class="text-2xl font-extrabold text-stone-800 tracking-tight">YouTube Tracker</h1>
      </div>
      <div class="flex gap-2">
        <button onclick="exportData()" class="p-2 hover:bg-stone-200 rounded-lg text-stone-500 transition-all" title="Export JSON">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
        </button>
        <button onclick="importData()" class="p-2 hover:bg-stone-200 rounded-lg text-stone-500 transition-all" title="Import JSON">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
        </button>
      </div>
    </header>

    <div id="view-dashboard">
      <div class="grid grid-cols-3 gap-4 mb-8">
        <div class="bg-white p-5 rounded-2xl shadow-sm border border-stone-100">
          <div class="text-stone-400 text-xs font-bold uppercase tracking-wider mb-1">Total</div>
          <div class="text-3xl font-black text-stone-800" id="stat-total">0</div>
        </div>
        <div class="bg-white p-5 rounded-2xl shadow-sm border border-stone-100">
          <div class="text-stone-400 text-xs font-bold uppercase tracking-wider mb-1">In Progress</div>
          <div class="text-3xl font-black text-rose-500" id="stat-active">0</div>
        </div>
        <div class="bg-white p-5 rounded-2xl shadow-sm border border-stone-100">
          <div class="text-stone-400 text-xs font-bold uppercase tracking-wider mb-1">Completed</div>
          <div class="text-3xl font-black text-emerald-500" id="stat-completed">0</div>
        </div>
      </div>

      <div class="flex justify-between items-end mb-6">
        <h2 class="text-xl font-bold text-stone-700">Recent Videos</h2>
        <button onclick="createNewVideo()" class="bg-stone-900 hover:bg-black text-white px-5 py-2.5 rounded-xl font-bold shadow-lg shadow-stone-200 transform hover:scale-105 transition-all flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
          New Video
        </button>
      </div>

      <div id="video-list" class="space-y-3">
        </div>
    </div>

    <div id="view-workspace" class="hidden">
      
      <button onclick="switchView('dashboard')" class="mb-6 flex items-center text-stone-500 hover:text-stone-800 font-bold transition-colors">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="mr-1"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
        Back to Dashboard
      </button>

      <div class="bg-white rounded-3xl shadow-xl shadow-stone-200/50 border border-stone-100 overflow-hidden">
        <div class="p-8 border-b border-stone-100">
          <div class="flex justify-between items-start gap-4">
            <div class="flex-1">
              <label class="block text-xs font-bold text-stone-400 uppercase tracking-wider mb-2">Video Title</label>
              <input type="text" id="active-title" 
                class="w-full text-2xl font-bold text-stone-800 bg-transparent border-none focus:ring-0 p-0 placeholder-stone-300" 
                placeholder="Untitled Video..."
                oninput="updateActiveVideoTitle(this.value)">
            </div>
            <button onclick="deleteActiveVideo()" class="text-stone-300 hover:text-rose-500 transition-colors p-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
            </button>
          </div>
          
          <div class="mt-6">
            <div class="flex justify-between text-sm font-bold text-stone-500 mb-2">
              <span id="progress-text">0% Complete</span>
              <span id="steps-text">0/15</span>
            </div>
            <div class="h-3 bg-stone-100 rounded-full overflow-hidden">
              <div id="progress-bar" class="h-full bg-rose-500 transition-all duration-500 ease-out rounded-full" style="width: 0%"></div>
            </div>
          </div>
        </div>

        <div class="p-8 bg-stone-50/50" id="steps-container">
          </div>
      </div>
    </div>

  </div>

  <script>
    // --- CONFIGURATION ---
    const STORAGE_KEY = 'zh_youtube_data';
    
    // The specific workflow steps from your uploaded table
    const WORKFLOW_GROUPS = [
      {
        title: "Descript: Transcript & Timestamps",
        steps: [
          "Upload to Descript & transcribe",
          "Copy & paste in doc",
          "Get timestamps"
        ]
      },
      {
        title: "Flowy: Contents",
        steps: [
          "Get title",
          "YouTube description"
        ]
      },
      {
        title: "Canva",
        steps: [
          "Create thumbnail",
          "Create IG image"
        ]
      },
      {
        title: "ClipChamp",
        steps: [
          "Separate audio & adjust",
          "Edit video & music",
          "Export"
        ]
      },
      {
        title: "YouTube",
        steps: [
          "Upload & copy link",
          "Add title & description"
        ]
      },
      {
        title: "Distribution",
        steps: [
          "Draft ZH weekly feature",
          "Create & schedule social posts",
          "Schedule on YouTube"
        ]
      }
    ];

    // --- STATE MANAGEMENT ---
    let videos = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
    let currentVideoId = null;

    // --- INITIALIZATION ---
    function init() {
      renderDashboard();
      // Check if we have an active session hash or something? For now defaults to dashboard.
    }

    // --- CORE FUNCTIONS ---
    function saveData() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(videos));
      updateStats();
    }

    function createNewVideo() {
      const newVideo = {
        id: Date.now().toString(),
        title: "",
        createdAt: new Date().toISOString(),
        completed: false,
        steps: {} // { "Upload to Descript...": true/false }
      };
      videos.unshift(newVideo);
      saveData();
      openVideo(newVideo.id);
    }

    function openVideo(id) {
      currentVideoId = id;
      const video = videos.find(v => v.id === id);
      if(!video) return;

      // Update UI for Workspace
      document.getElementById('view-dashboard').classList.add('hidden');
      document.getElementById('view-workspace').classList.remove('hidden');
      
      document.getElementById('active-title').value = video.title;
      renderSteps(video);
      updateProgress(video);
      window.scrollTo(0, 0);
    }

    function switchView(viewName) {
      if (viewName === 'dashboard') {
        document.getElementById('view-workspace').classList.add('hidden');
        document.getElementById('view-dashboard').classList.remove('hidden');
        renderDashboard();
        currentVideoId = null;
      }
    }

    function updateActiveVideoTitle(newTitle) {
      const video = videos.find(v => v.id === currentVideoId);
      if (video) {
        video.title = newTitle;
        saveData();
      }
    }

    function toggleStep(stepName) {
      const video = videos.find(v => v.id === currentVideoId);
      if (video) {
        // Toggle state
        video.steps[stepName] = !video.steps[stepName];
        
        // Check for full completion
        const allSteps = WORKFLOW_GROUPS.flatMap(g => g.steps);
        const allDone = allSteps.every(s => video.steps[s]);
        video.completed = allDone;

        saveData();
        renderSteps(video); // Re-render to update checkbox styles
        updateProgress(video);
      }
    }

    function deleteActiveVideo() {
      if(confirm('Are you sure you want to delete this video tracker?')) {
        videos = videos.filter(v => v.id !== currentVideoId);
        saveData();
        switchView('dashboard');
      }
    }

    // --- RENDERING ---

    function renderDashboard() {
      const list = document.getElementById('video-list');
      list.innerHTML = '';

      if (videos.length === 0) {
        list.innerHTML = `
          <div class="text-center py-12 bg-white rounded-2xl border border-stone-100 border-dashed">
            <p class="text-stone-400 font-medium">No videos yet. Start your first one!</p>
          </div>`;
      } else {
        videos.forEach(video => {
          // Calculate progress for preview
          const allSteps = WORKFLOW_GROUPS.flatMap(g => g.steps);
          const doneCount = allSteps.filter(s => video.steps[s]).length;
          const pct = Math.round((doneCount / allSteps.length) * 100);

          const el = document.createElement('div');
          el.className = `bg-white p-4 rounded-xl shadow-sm border border-stone-100 hover:shadow-md transition-all cursor-pointer flex items-center justify-between group`;
          el.onclick = () => openVideo(video.id);
          el.innerHTML = `
            <div class="flex-1">
              <h3 class="font-bold text-stone-800 ${!video.title ? 'italic text-stone-400' : ''}">${video.title || 'Untitled Video'}</h3>
              <div class="text-xs text-stone-400 mt-1 flex items-center gap-2">
                <span>${new Date(video.createdAt).toLocaleDateString()}</span>
                <span class="w-1 h-1 bg-stone-300 rounded-full"></span>
                <span class="${pct === 100 ? 'text-emerald-500 font-bold' : 'text-stone-400'}">${pct}% Done</span>
              </div>
            </div>
            <div class="flex items-center gap-3">
               ${pct === 100 
                 ? `<span class="bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full text-xs font-bold">Done</span>` 
                 : `<div class="w-16 h-2 bg-stone-100 rounded-full overflow-hidden"><div class="h-full bg-rose-500" style="width: ${pct}%"></div></div>`
               }
               <svg class="text-stone-300 group-hover:text-stone-600 transition-colors" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
            </div>
          `;
          list.appendChild(el);
        });
      }
      updateStats();
    }

    function renderSteps(video) {
      const container = document.getElementById('steps-container');
      container.innerHTML = '';

      WORKFLOW_GROUPS.forEach(group => {
        const groupDiv = document.createElement('div');
        groupDiv.className = 'mb-8 last:mb-0';
        
        groupDiv.innerHTML = `<h4 class="text-sm font-extrabold text-stone-400 uppercase tracking-widest mb-4 ml-1">${group.title}</h4>`;
        
        const stepsList = document.createElement('div');
        stepsList.className = 'space-y-3';

        group.steps.forEach(step => {
          const isDone = video.steps[step];
          const btn = document.createElement('div');
          // Style based on state
          const baseClass = "flex items-center p-4 rounded-xl cursor-pointer border transition-all duration-200 group select-none";
          const activeClass = isDone 
            ? "bg-emerald-50 border-emerald-200" 
            : "bg-white border-stone-200 hover:border-stone-300 hover:shadow-sm";
          
          btn.className = `${baseClass} ${activeClass}`;
          btn.onclick = () => toggleStep(step);

          btn.innerHTML = `
            <div class="w-6 h-6 rounded-lg border-2 flex items-center justify-center mr-4 transition-colors ${isDone ? 'bg-emerald-500 border-emerald-500' : 'border-stone-300 bg-stone-50 group-hover:border-stone-400'}">
              ${isDone ? '<svg class="text-white" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>' : ''}
            </div>
            <span class="font-medium ${isDone ? 'text-emerald-800 line-through decoration-emerald-300/50' : 'text-stone-700'}">${step}</span>
          `;
          stepsList.appendChild(btn);
        });

        groupDiv.appendChild(stepsList);
        container.appendChild(groupDiv);
      });
    }

    function updateStats() {
      const total = videos.length;
      const completed = videos.filter(v => v.completed).length;
      const active = total - completed;

      document.getElementById('stat-total').innerText = total;
      document.getElementById('stat-active').innerText = active;
      document.getElementById('stat-completed').innerText = completed;
    }

    function updateProgress(video) {
      const allSteps = WORKFLOW_GROUPS.flatMap(g => g.steps);
      const doneCount = allSteps.filter(s => video.steps[s]).length;
      const totalCount = allSteps.length;
      const pct = Math.round((doneCount / totalCount) * 100);

      document.getElementById('progress-bar').style.width = `${pct}%`;
      document.getElementById('progress-bar').className = `h-full transition-all duration-500 ease-out rounded-full ${pct === 100 ? 'bg-emerald-500' : 'bg-rose-500'}`;
      document.getElementById('progress-text').innerText = `${pct}% Complete`;
      document.getElementById('steps-text').innerText = `${doneCount}/${totalCount}`;
    }

    // --- DATA IMPORT/EXPORT ---
    function exportData() {
      const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(videos));
      const downloadAnchorNode = document.createElement('a');
      downloadAnchorNode.setAttribute("href", dataStr);
      downloadAnchorNode.setAttribute("download", "youtube-tracker-backup.json");
      document.body.appendChild(downloadAnchorNode);
      downloadAnchorNode.click();
      downloadAnchorNode.remove();
    }

    function importData() {
      const input = document.createElement('input');
      input.type = 'file';
      input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.readAsText(file, 'UTF-8');
        reader.onload = readerEvent => {
          try {
            const content = JSON.parse(readerEvent.target.result);
            if(Array.isArray(content)) {
              videos = content;
              saveData();
              renderDashboard();
              alert('Import successful!');
            }
          } catch(err) {
            alert('Error reading file');
          }
        }
      }
      input.click();
    }

    // Run
    init();
  </script>
</body>
</html>
